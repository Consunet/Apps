
var __cov_PgXs5Da8YdebSaLYg9T9iA = (Function('return this'))();
if (!__cov_PgXs5Da8YdebSaLYg9T9iA.__coverage__) { __cov_PgXs5Da8YdebSaLYg9T9iA.__coverage__ = {}; }
__cov_PgXs5Da8YdebSaLYg9T9iA = __cov_PgXs5Da8YdebSaLYg9T9iA.__coverage__;
if (!(__cov_PgXs5Da8YdebSaLYg9T9iA['/home/ubuntudev/Documents/NetBeans Projects/ConsunetApps/WhisperNote/src/app.js'])) {
   __cov_PgXs5Da8YdebSaLYg9T9iA['/home/ubuntudev/Documents/NetBeans Projects/ConsunetApps/WhisperNote/src/app.js'] = {"path":"/home/ubuntudev/Documents/NetBeans Projects/ConsunetApps/WhisperNote/src/app.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},"fnMap":{"1":{"name":"(anonymous_1)","line":20,"loc":{"start":{"line":20,"column":14},"end":{"line":20,"column":25}}},"2":{"name":"(anonymous_2)","line":27,"loc":{"start":{"line":27,"column":28},"end":{"line":27,"column":39}}},"3":{"name":"(anonymous_3)","line":49,"loc":{"start":{"line":49,"column":22},"end":{"line":49,"column":54}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":21},"end":{"line":52,"column":32}}},"5":{"name":"(anonymous_5)","line":57,"loc":{"start":{"line":57,"column":13},"end":{"line":57,"column":31}}},"6":{"name":"(anonymous_6)","line":77,"loc":{"start":{"line":77,"column":26},"end":{"line":77,"column":77}}},"7":{"name":"(anonymous_7)","line":81,"loc":{"start":{"line":81,"column":28},"end":{"line":81,"column":63}}},"8":{"name":"(anonymous_8)","line":100,"loc":{"start":{"line":100,"column":33},"end":{"line":100,"column":60}}},"9":{"name":"(anonymous_9)","line":101,"loc":{"start":{"line":101,"column":58},"end":{"line":101,"column":84}}},"10":{"name":"(anonymous_10)","line":103,"loc":{"start":{"line":103,"column":43},"end":{"line":103,"column":58}}},"11":{"name":"(anonymous_11)","line":109,"loc":{"start":{"line":109,"column":24},"end":{"line":109,"column":36}}},"12":{"name":"(anonymous_12)","line":112,"loc":{"start":{"line":112,"column":43},"end":{"line":112,"column":58}}},"13":{"name":"(anonymous_13)","line":117,"loc":{"start":{"line":117,"column":29},"end":{"line":117,"column":47}}},"14":{"name":"(anonymous_14)","line":120,"loc":{"start":{"line":120,"column":25},"end":{"line":120,"column":43}}},"15":{"name":"(anonymous_15)","line":134,"loc":{"start":{"line":134,"column":17},"end":{"line":134,"column":28}}},"16":{"name":"(anonymous_16)","line":142,"loc":{"start":{"line":142,"column":14},"end":{"line":142,"column":25}}},"17":{"name":"(anonymous_17)","line":146,"loc":{"start":{"line":146,"column":45},"end":{"line":146,"column":78}}},"18":{"name":"(anonymous_18)","line":191,"loc":{"start":{"line":191,"column":37},"end":{"line":191,"column":64}}},"19":{"name":"(anonymous_19)","line":192,"loc":{"start":{"line":192,"column":51},"end":{"line":192,"column":77}}},"20":{"name":"(anonymous_20)","line":207,"loc":{"start":{"line":207,"column":29},"end":{"line":207,"column":47}}},"21":{"name":"(anonymous_21)","line":217,"loc":{"start":{"line":217,"column":28},"end":{"line":217,"column":45}}},"22":{"name":"(anonymous_22)","line":222,"loc":{"start":{"line":222,"column":18},"end":{"line":222,"column":30}}},"23":{"name":"(anonymous_23)","line":223,"loc":{"start":{"line":223,"column":28},"end":{"line":223,"column":62}}},"24":{"name":"(anonymous_24)","line":253,"loc":{"start":{"line":253,"column":24},"end":{"line":253,"column":35}}},"25":{"name":"(anonymous_25)","line":263,"loc":{"start":{"line":263,"column":18},"end":{"line":263,"column":39}}}},"statementMap":{"1":{"start":{"line":20,"column":0},"end":{"line":36,"column":2}},"2":{"start":{"line":21,"column":4},"end":{"line":21,"column":41}},"3":{"start":{"line":23,"column":4},"end":{"line":23,"column":28}},"4":{"start":{"line":24,"column":4},"end":{"line":35,"column":5}},"5":{"start":{"line":25,"column":8},"end":{"line":25,"column":24}},"6":{"start":{"line":26,"column":8},"end":{"line":26,"column":42}},"7":{"start":{"line":27,"column":8},"end":{"line":30,"column":10}},"8":{"start":{"line":28,"column":12},"end":{"line":28,"column":38}},"9":{"start":{"line":29,"column":12},"end":{"line":29,"column":56}},"10":{"start":{"line":32,"column":8},"end":{"line":32,"column":43}},"11":{"start":{"line":34,"column":8},"end":{"line":34,"column":42}},"12":{"start":{"line":49,"column":0},"end":{"line":62,"column":2}},"13":{"start":{"line":50,"column":4},"end":{"line":50,"column":18}},"14":{"start":{"line":51,"column":4},"end":{"line":51,"column":70}},"15":{"start":{"line":52,"column":4},"end":{"line":61,"column":7}},"16":{"start":{"line":53,"column":8},"end":{"line":53,"column":26}},"17":{"start":{"line":54,"column":8},"end":{"line":54,"column":32}},"18":{"start":{"line":55,"column":8},"end":{"line":55,"column":47}},"19":{"start":{"line":56,"column":8},"end":{"line":56,"column":22}},"20":{"start":{"line":58,"column":8},"end":{"line":58,"column":59}},"21":{"start":{"line":59,"column":8},"end":{"line":59,"column":28}},"22":{"start":{"line":60,"column":8},"end":{"line":60,"column":22}},"23":{"start":{"line":77,"column":0},"end":{"line":128,"column":2}},"24":{"start":{"line":79,"column":4},"end":{"line":79,"column":18}},"25":{"start":{"line":81,"column":4},"end":{"line":127,"column":26}},"26":{"start":{"line":82,"column":8},"end":{"line":82,"column":25}},"27":{"start":{"line":83,"column":8},"end":{"line":83,"column":21}},"28":{"start":{"line":85,"column":8},"end":{"line":85,"column":39}},"29":{"start":{"line":87,"column":8},"end":{"line":124,"column":9}},"30":{"start":{"line":88,"column":12},"end":{"line":88,"column":42}},"31":{"start":{"line":90,"column":12},"end":{"line":90,"column":47}},"32":{"start":{"line":91,"column":12},"end":{"line":91,"column":45}},"33":{"start":{"line":93,"column":12},"end":{"line":98,"column":13}},"34":{"start":{"line":94,"column":16},"end":{"line":94,"column":74}},"35":{"start":{"line":95,"column":16},"end":{"line":95,"column":54}},"36":{"start":{"line":96,"column":16},"end":{"line":96,"column":124}},"37":{"start":{"line":97,"column":16},"end":{"line":97,"column":61}},"38":{"start":{"line":100,"column":12},"end":{"line":123,"column":15}},"39":{"start":{"line":101,"column":16},"end":{"line":122,"column":19}},"40":{"start":{"line":102,"column":20},"end":{"line":102,"column":51}},"41":{"start":{"line":103,"column":20},"end":{"line":107,"column":23}},"42":{"start":{"line":104,"column":24},"end":{"line":104,"column":60}},"43":{"start":{"line":105,"column":24},"end":{"line":105,"column":97}},"44":{"start":{"line":106,"column":24},"end":{"line":106,"column":73}},"45":{"start":{"line":108,"column":20},"end":{"line":108,"column":52}},"46":{"start":{"line":110,"column":20},"end":{"line":110,"column":86}},"47":{"start":{"line":111,"column":20},"end":{"line":111,"column":129}},"48":{"start":{"line":112,"column":20},"end":{"line":119,"column":23}},"49":{"start":{"line":113,"column":24},"end":{"line":113,"column":60}},"50":{"start":{"line":114,"column":24},"end":{"line":114,"column":100}},"51":{"start":{"line":115,"column":24},"end":{"line":115,"column":62}},"52":{"start":{"line":116,"column":24},"end":{"line":116,"column":34}},"53":{"start":{"line":118,"column":24},"end":{"line":118,"column":39}},"54":{"start":{"line":121,"column":20},"end":{"line":121,"column":35}},"55":{"start":{"line":126,"column":8},"end":{"line":126,"column":22}},"56":{"start":{"line":134,"column":0},"end":{"line":136,"column":2}},"57":{"start":{"line":135,"column":4},"end":{"line":135,"column":39}},"58":{"start":{"line":142,"column":0},"end":{"line":220,"column":2}},"59":{"start":{"line":144,"column":4},"end":{"line":144,"column":18}},"60":{"start":{"line":146,"column":4},"end":{"line":215,"column":7}},"61":{"start":{"line":149,"column":8},"end":{"line":149,"column":37}},"62":{"start":{"line":151,"column":8},"end":{"line":151,"column":39}},"63":{"start":{"line":154,"column":8},"end":{"line":212,"column":9}},"64":{"start":{"line":155,"column":12},"end":{"line":211,"column":13}},"65":{"start":{"line":157,"column":16},"end":{"line":157,"column":87}},"66":{"start":{"line":158,"column":16},"end":{"line":158,"column":127}},"67":{"start":{"line":159,"column":16},"end":{"line":159,"column":94}},"68":{"start":{"line":160,"column":16},"end":{"line":160,"column":70}},"69":{"start":{"line":161,"column":16},"end":{"line":161,"column":57}},"70":{"start":{"line":163,"column":16},"end":{"line":163,"column":36}},"71":{"start":{"line":164,"column":16},"end":{"line":170,"column":17}},"72":{"start":{"line":165,"column":20},"end":{"line":165,"column":78}},"73":{"start":{"line":166,"column":20},"end":{"line":166,"column":112}},"74":{"start":{"line":167,"column":20},"end":{"line":167,"column":85}},"75":{"start":{"line":168,"column":20},"end":{"line":168,"column":74}},"76":{"start":{"line":169,"column":20},"end":{"line":169,"column":52}},"77":{"start":{"line":172,"column":16},"end":{"line":172,"column":87}},"78":{"start":{"line":173,"column":16},"end":{"line":173,"column":48}},"79":{"start":{"line":177,"column":16},"end":{"line":177,"column":46}},"80":{"start":{"line":179,"column":16},"end":{"line":179,"column":38}},"81":{"start":{"line":181,"column":16},"end":{"line":181,"column":90}},"82":{"start":{"line":182,"column":16},"end":{"line":182,"column":132}},"83":{"start":{"line":183,"column":16},"end":{"line":183,"column":61}},"84":{"start":{"line":185,"column":16},"end":{"line":189,"column":17}},"85":{"start":{"line":186,"column":20},"end":{"line":186,"column":97}},"86":{"start":{"line":187,"column":20},"end":{"line":187,"column":130}},"87":{"start":{"line":188,"column":20},"end":{"line":188,"column":62}},"88":{"start":{"line":191,"column":16},"end":{"line":210,"column":19}},"89":{"start":{"line":192,"column":20},"end":{"line":209,"column":23}},"90":{"start":{"line":193,"column":24},"end":{"line":193,"column":93}},"91":{"start":{"line":194,"column":24},"end":{"line":194,"column":69}},"92":{"start":{"line":195,"column":24},"end":{"line":195,"column":65}},"93":{"start":{"line":197,"column":24},"end":{"line":197,"column":44}},"94":{"start":{"line":198,"column":24},"end":{"line":201,"column":25}},"95":{"start":{"line":199,"column":28},"end":{"line":199,"column":74}},"96":{"start":{"line":200,"column":28},"end":{"line":200,"column":51}},"97":{"start":{"line":203,"column":24},"end":{"line":203,"column":95}},"98":{"start":{"line":204,"column":24},"end":{"line":204,"column":47}},"99":{"start":{"line":206,"column":24},"end":{"line":206,"column":34}},"100":{"start":{"line":208,"column":24},"end":{"line":208,"column":39}},"101":{"start":{"line":214,"column":8},"end":{"line":214,"column":22}},"102":{"start":{"line":217,"column":4},"end":{"line":219,"column":7}},"103":{"start":{"line":218,"column":7},"end":{"line":218,"column":58}},"104":{"start":{"line":222,"column":0},"end":{"line":248,"column":1}},"105":{"start":{"line":223,"column":4},"end":{"line":247,"column":7}},"106":{"start":{"line":225,"column":8},"end":{"line":225,"column":37}},"107":{"start":{"line":228,"column":8},"end":{"line":246,"column":9}},"108":{"start":{"line":229,"column":12},"end":{"line":229,"column":83}},"109":{"start":{"line":230,"column":12},"end":{"line":230,"column":123}},"110":{"start":{"line":231,"column":12},"end":{"line":231,"column":90}},"111":{"start":{"line":232,"column":12},"end":{"line":232,"column":66}},"112":{"start":{"line":233,"column":12},"end":{"line":233,"column":53}},"113":{"start":{"line":235,"column":12},"end":{"line":235,"column":32}},"114":{"start":{"line":236,"column":12},"end":{"line":242,"column":13}},"115":{"start":{"line":237,"column":16},"end":{"line":237,"column":74}},"116":{"start":{"line":238,"column":16},"end":{"line":238,"column":108}},"117":{"start":{"line":239,"column":16},"end":{"line":239,"column":81}},"118":{"start":{"line":240,"column":16},"end":{"line":240,"column":70}},"119":{"start":{"line":241,"column":16},"end":{"line":241,"column":48}},"120":{"start":{"line":244,"column":12},"end":{"line":244,"column":83}},"121":{"start":{"line":245,"column":12},"end":{"line":245,"column":44}},"122":{"start":{"line":253,"column":0},"end":{"line":255,"column":2}},"123":{"start":{"line":254,"column":4},"end":{"line":254,"column":39}},"124":{"start":{"line":263,"column":0},"end":{"line":269,"column":2}},"125":{"start":{"line":264,"column":4},"end":{"line":264,"column":55}},"126":{"start":{"line":265,"column":4},"end":{"line":265,"column":57}},"127":{"start":{"line":267,"column":4},"end":{"line":267,"column":45}},"128":{"start":{"line":268,"column":4},"end":{"line":268,"column":49}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":4}},{"start":{"line":24,"column":4},"end":{"line":24,"column":4}}]},"2":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":8},"end":{"line":87,"column":8}},{"start":{"line":87,"column":8},"end":{"line":87,"column":8}}]},"3":{"line":154,"type":"if","locations":[{"start":{"line":154,"column":8},"end":{"line":154,"column":8}},{"start":{"line":154,"column":8},"end":{"line":154,"column":8}}]},"4":{"line":155,"type":"if","locations":[{"start":{"line":155,"column":12},"end":{"line":155,"column":12}},{"start":{"line":155,"column":12},"end":{"line":155,"column":12}}]},"5":{"line":228,"type":"if","locations":[{"start":{"line":228,"column":8},"end":{"line":228,"column":8}},{"start":{"line":228,"column":8},"end":{"line":228,"column":8}}]},"6":{"line":264,"type":"cond-expr","locations":[{"start":{"line":264,"column":37},"end":{"line":264,"column":43}},{"start":{"line":264,"column":46},"end":{"line":264,"column":54}}]},"7":{"line":265,"type":"cond-expr","locations":[{"start":{"line":265,"column":39},"end":{"line":265,"column":47}},{"start":{"line":265,"column":50},"end":{"line":265,"column":56}}]}},"code":["(function () { /**"," * @file functions to encapsulate interface logic for the WhisperNote app"," */","","/**"," * @namespace SCA"," * @type {object}"," * @description"," * <p>"," * These functions build upon the SCA namespace to provide an interface for the WhisperNote app."," * </p>"," */","","","/**"," * Reads the chosen file to encrypt and performs the encryption once "," * the data has been loaded."," * If there is no file chosen, the encryption is performed without the file."," */","SCA.encrypt = function() {","    var fileInput = this.e('file').files;","","    var file = fileInput[0];","    if (file) {","        var arrayBuffer;","        var fileReader = new FileReader();","        fileReader.onload = function() {","            arrayBuffer = this.result;","            SCA.encryptWithFile(arrayBuffer, file.name);","        };","","        fileReader.readAsArrayBuffer(file);","    } else {","        SCA.encryptWithFile(false, false);","    }","};","","/**"," * Stores the payload text and attachment data (if provided) as an encrypted"," * object within the DOM, saves the file and then resets the document."," * <p>"," * This encryption is performed in an asynchronous manner, and it is an error"," * to assume that the encryption and persistence has occurred as soon as this"," * function returns."," * "," * @param {ArrayBuffer} arrayBuffer - the file data to encrypt, if provided."," * @param {string} filename - the name of the file, if provided."," */","SCA.encryptWithFile = function(arrayBuffer, filename) {","    var me = this;","    var eaedPromise = this.encryptAndEmbedData(arrayBuffer, filename);","    eaedPromise.then(function() {","        me.saveDocument();","        me.e('file').value = \"\"; // remove selected file.","        SCA.setDisplay(\"att-download\", \"none\"); // hide download button.","        me.doOnload();","    }).catch(function (reason) {","        var errstr = \"Encryption failed due to: \" + reason;","        console.log(errstr);","        alert(errstr);","    });","};","","/**"," * Stores the payload text and attachment data (if provided) as an encrypted"," * object within the DOM. "," * <p>"," * This is performed in an asynchronous manner, via the returned Promise."," * "," * @param {ArrayBuffer} arrayBuffer - the file data to encrypt, if provided."," * @param {string} filename - the name of the file, if provided."," * @param {boolean} skipPasswdWarning - if true, prevents confirmation dialogs related to password strength "," * from appearing and halting encryption testing."," * @return {Promise} when retruned promise is resolved, page data will be "," *      encrypted and embedded, ready for persistence."," */","SCA.encryptAndEmbedData = function(arrayBuffer, filename, skipPasswdWarning) {","    ","    var me = this;","    ","    return this.encryptWith(function(cs, cryptoKey, iv, adata) {","        cs.cattname = \"\";","        cs.catt = \"\";","        ","        var retval = Promise.resolve();","        ","        if (arrayBuffer) {","            var sc = window.crypto.subtle;","            ","            var sliceSize = CONST.attSliceSize;","            var encryptionPromisesArray = [];","            ","            for (var offset = 0; offset < arrayBuffer.byteLength; offset += sliceSize) {","                var slice = arrayBuffer.slice(offset, offset + sliceSize);","                var byteSlice = new Uint8Array(slice);","                var encryptPromise = sc.encrypt({'name': cs.cipherAlgorithm, 'iv': iv.buffer}, cryptoKey, byteSlice.buffer);","                encryptionPromisesArray.push(encryptPromise);","            }","            ","            retval = new Promise(function (resolve, reject) {","                Promise.all(encryptionPromisesArray).then(function (encryptedArray) {","                    var encryptedBase64Slices = [];","                    encryptedArray.forEach(function (val) {","                        var byteArray = new Uint8Array(val);","                        var encryptedBase64Slice = me.convertUint8ArrayToBase64String(byteArray);","                        encryptedBase64Slices.push(encryptedBase64Slice);","                    });","                    cs.catt = encryptedBase64Slices;","                }).then(function () {","                    var filenameBuffer = me.convertUtf16StringToArrayBuffer(filename);","                    var encryptionPromise = sc.encrypt({'name': cs.cipherAlgorithm, 'iv': iv.buffer}, cryptoKey, filenameBuffer);","                    encryptionPromise.then(function (val) {","                        var byteArray = new Uint8Array(val);","                        var encryptedBase64Filename = me.convertUint8ArrayToBase64String(byteArray);","                        cs.cattname = encryptedBase64Filename;","                        resolve(); // retval","                    }).catch(function (reason) {","                        reject(reason); // retval","                    });","                }).catch(function (reason) {","                    reject(reason); // retval","                });","            });","        }","        ","        return retval;","    }, skipPasswdWarning);","};","","/**"," * Gets the plaintext message payload to be encrypted."," * @returns {string} - the message to be encrypted in plaintext."," */","SCA.getPayload = function() {","    return this.getAndClear(\"payload\");","};","","/**"," * Decrypts the payload and file attachment data (if provided)."," * The attachment blob and file name are stored in memory, ready to be downloaded."," */","SCA.decrypt = function() {","    ","    var me = this;","    ","    var decryptionPromise = this.decryptWith(function(v, key, iv, adata, out) {","        ","        // Populate the message payload","        SCA.e(\"payload\").value = out;","        ","        var retval = Promise.resolve();","        ","        // Check for an attachment, and decrypt it if present","        if (encData.cattname) {","            if (v < 1.4) {","                // in this branch key is required to be a SJCL algorithum/password pair","                var encryptedFilenameBits = sjcl.codec.base64.toBits(encData.cattname);","                var decryptedFilenameBits = sjcl.mode[encData.mode].decrypt(key, encryptedFilenameBits, iv, adata, encData.ts);","                var decryptedFilename = sjcl.codec.utf8String.fromBits(decryptedFilenameBits);","                SCA.e(\"download-label\").innerHTML = decryptedFilename;","                SCA.setDisplay(\"att-download\", \"inline\");","","                var byteArrays = [];","                for (var i = 0; i < encData.catt.length; i++) {","                    var sliceBits = sjcl.codec.base64.toBits(encData.catt[i]);","                    var decryptedSlice = sjcl.mode[encData.mode].decrypt(key, sliceBits, iv, adata, encData.ts);","                    var byteNumbersSlice = sjcl.codec.bytes.fromBits(decryptedSlice);","                    var byteArraySlice = new Uint8Array(byteNumbersSlice);","                    byteArrays.push(byteArraySlice);","                }","","                SCA.attBlob = new Blob(byteArrays, {type: \"application/octet-stream\"});","                SCA.attName = decryptedFilename;","            } else {","                // in this branch key is required to be a CryptoKey","","                var sc = window.crypto.subtle;","","                var promiseArray = [];","","                var filenameBuffer = me.convertBase64StringToUint8Array(encData.cattname);","                var filenameDecryptionPromise = sc.decrypt({'name': encData.cipherAlgorithm, 'iv': iv.buffer}, key, filenameBuffer);","                promiseArray.push(filenameDecryptionPromise);","","                for (var i = 0; i < encData.catt.length; i++) {","                    var sliceBuffer = me.convertBase64StringToUint8Array(encData.catt[i]).buffer;","                    var sliceDecryptionPromise = sc.decrypt({'name': encData.cipherAlgorithm, 'iv': iv.buffer}, key, sliceBuffer);","                    promiseArray.push(sliceDecryptionPromise);","                }","","                retval = new Promise(function (resolve, reject) {","                    Promise.all(promiseArray).then(function (decryptedArray) {","                        var filename = me.convertArrayBufferToUtf16String(decryptedArray[0]);","                        SCA.e(\"download-label\").innerHTML = filename;","                        SCA.setDisplay(\"att-download\", \"inline\");","","                        var bytesArray = [];","                        for (var i = 1; i < decryptedArray.length; i++) {","                            var slice = new Uint8Array(decryptedArray[i]);","                            bytesArray.push(slice);","                        }","","                        SCA.attBlob = new Blob(bytesArray, {type: \"application/octet-stream\"});","                        SCA.attName = filename;","","                        resolve();","                    }).catch(function (reason) {","                        reject(reason);","                    });","                });","            } // end else","        } // end if (encData.cattname)","","        return retval;","    });","    ","    decryptionPromise.catch(function(reason) {","       console.log(\"Decryption failed due to: \" + reason); ","    });","};","","SCA.decryptSJCL = function () {","    return this.decryptWith(function (v, prp, iv, adata, out) {","        // Populate the message payload","        SCA.e(\"payload\").value = out;","","        // Check for an attachment, and decrypt it if present","        if (encData.cattname) {","            var encryptedFilenameBits = sjcl.codec.base64.toBits(encData.cattname);","            var decryptedFilenameBits = sjcl.mode[encData.mode].decrypt(prp, encryptedFilenameBits, iv, adata, encData.ts);","            var decryptedFilename = sjcl.codec.utf8String.fromBits(decryptedFilenameBits);","            SCA.e(\"download-label\").innerHTML = decryptedFilename;","            SCA.setDisplay(\"att-download\", \"inline\");","","            var byteArrays = [];","            for (var i = 0; i < encData.catt.length; i++) {","                var sliceBits = sjcl.codec.base64.toBits(encData.catt[i]);","                var decryptedSlice = sjcl.mode[encData.mode].decrypt(prp, sliceBits, iv, adata, encData.ts);","                var byteNumbersSlice = sjcl.codec.bytes.fromBits(decryptedSlice);","                var byteArraySlice = new Uint8Array(byteNumbersSlice);","                byteArrays.push(byteArraySlice);","            }","","            SCA.attBlob = new Blob(byteArrays, {type: \"application/octet-stream\"});","            SCA.attName = decryptedFilename;","        }","    });","}","","/**"," * Downloads the stores attachment blob and filename."," */","SCA.downloadDecrypted = function() {","    saveAs(this.attBlob, this.attName);","};","","/**"," * Sets whether or not the interface is unlocked or not."," * When locked, the encrypted password data needs to be decrypted in order to unlock the interface."," * "," * @param {boolean} isUnlocked - true if the interface is unlocked, false otherwise"," */","SCA.setUnlocked = function(isUnlocked) {","    var lockedDisplay = isUnlocked ? \"none\" : \"inline\";","    var unlockedDisplay = isUnlocked ? \"inline\" : \"none\";","","    this.setDisplay(\"locked\", lockedDisplay);","    this.setDisplay(\"unlocked\", unlockedDisplay);","};","}());"]};
}
__cov_PgXs5Da8YdebSaLYg9T9iA = __cov_PgXs5Da8YdebSaLYg9T9iA['/home/ubuntudev/Documents/NetBeans Projects/ConsunetApps/WhisperNote/src/app.js'];
__cov_PgXs5Da8YdebSaLYg9T9iA.s['1']++;SCA.encrypt=function(){__cov_PgXs5Da8YdebSaLYg9T9iA.f['1']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['2']++;var fileInput=this.e('file').files;__cov_PgXs5Da8YdebSaLYg9T9iA.s['3']++;var file=fileInput[0];__cov_PgXs5Da8YdebSaLYg9T9iA.s['4']++;if(file){__cov_PgXs5Da8YdebSaLYg9T9iA.b['1'][0]++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['5']++;var arrayBuffer;__cov_PgXs5Da8YdebSaLYg9T9iA.s['6']++;var fileReader=new FileReader();__cov_PgXs5Da8YdebSaLYg9T9iA.s['7']++;fileReader.onload=function(){__cov_PgXs5Da8YdebSaLYg9T9iA.f['2']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['8']++;arrayBuffer=this.result;__cov_PgXs5Da8YdebSaLYg9T9iA.s['9']++;SCA.encryptWithFile(arrayBuffer,file.name);};__cov_PgXs5Da8YdebSaLYg9T9iA.s['10']++;fileReader.readAsArrayBuffer(file);}else{__cov_PgXs5Da8YdebSaLYg9T9iA.b['1'][1]++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['11']++;SCA.encryptWithFile(false,false);}};__cov_PgXs5Da8YdebSaLYg9T9iA.s['12']++;SCA.encryptWithFile=function(arrayBuffer,filename){__cov_PgXs5Da8YdebSaLYg9T9iA.f['3']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['13']++;var me=this;__cov_PgXs5Da8YdebSaLYg9T9iA.s['14']++;var eaedPromise=this.encryptAndEmbedData(arrayBuffer,filename);__cov_PgXs5Da8YdebSaLYg9T9iA.s['15']++;eaedPromise.then(function(){__cov_PgXs5Da8YdebSaLYg9T9iA.f['4']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['16']++;me.saveDocument();__cov_PgXs5Da8YdebSaLYg9T9iA.s['17']++;me.e('file').value='';__cov_PgXs5Da8YdebSaLYg9T9iA.s['18']++;SCA.setDisplay('att-download','none');__cov_PgXs5Da8YdebSaLYg9T9iA.s['19']++;me.doOnload();}).catch(function(reason){__cov_PgXs5Da8YdebSaLYg9T9iA.f['5']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['20']++;var errstr='Encryption failed due to: '+reason;__cov_PgXs5Da8YdebSaLYg9T9iA.s['21']++;console.log(errstr);__cov_PgXs5Da8YdebSaLYg9T9iA.s['22']++;alert(errstr);});};__cov_PgXs5Da8YdebSaLYg9T9iA.s['23']++;SCA.encryptAndEmbedData=function(arrayBuffer,filename,skipPasswdWarning){__cov_PgXs5Da8YdebSaLYg9T9iA.f['6']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['24']++;var me=this;__cov_PgXs5Da8YdebSaLYg9T9iA.s['25']++;return this.encryptWith(function(cs,cryptoKey,iv,adata){__cov_PgXs5Da8YdebSaLYg9T9iA.f['7']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['26']++;cs.cattname='';__cov_PgXs5Da8YdebSaLYg9T9iA.s['27']++;cs.catt='';__cov_PgXs5Da8YdebSaLYg9T9iA.s['28']++;var retval=Promise.resolve();__cov_PgXs5Da8YdebSaLYg9T9iA.s['29']++;if(arrayBuffer){__cov_PgXs5Da8YdebSaLYg9T9iA.b['2'][0]++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['30']++;var sc=window.crypto.subtle;__cov_PgXs5Da8YdebSaLYg9T9iA.s['31']++;var sliceSize=CONST.attSliceSize;__cov_PgXs5Da8YdebSaLYg9T9iA.s['32']++;var encryptionPromisesArray=[];__cov_PgXs5Da8YdebSaLYg9T9iA.s['33']++;for(var offset=0;offset<arrayBuffer.byteLength;offset+=sliceSize){__cov_PgXs5Da8YdebSaLYg9T9iA.s['34']++;var slice=arrayBuffer.slice(offset,offset+sliceSize);__cov_PgXs5Da8YdebSaLYg9T9iA.s['35']++;var byteSlice=new Uint8Array(slice);__cov_PgXs5Da8YdebSaLYg9T9iA.s['36']++;var encryptPromise=sc.encrypt({'name':cs.cipherAlgorithm,'iv':iv.buffer},cryptoKey,byteSlice.buffer);__cov_PgXs5Da8YdebSaLYg9T9iA.s['37']++;encryptionPromisesArray.push(encryptPromise);}__cov_PgXs5Da8YdebSaLYg9T9iA.s['38']++;retval=new Promise(function(resolve,reject){__cov_PgXs5Da8YdebSaLYg9T9iA.f['8']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['39']++;Promise.all(encryptionPromisesArray).then(function(encryptedArray){__cov_PgXs5Da8YdebSaLYg9T9iA.f['9']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['40']++;var encryptedBase64Slices=[];__cov_PgXs5Da8YdebSaLYg9T9iA.s['41']++;encryptedArray.forEach(function(val){__cov_PgXs5Da8YdebSaLYg9T9iA.f['10']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['42']++;var byteArray=new Uint8Array(val);__cov_PgXs5Da8YdebSaLYg9T9iA.s['43']++;var encryptedBase64Slice=me.convertUint8ArrayToBase64String(byteArray);__cov_PgXs5Da8YdebSaLYg9T9iA.s['44']++;encryptedBase64Slices.push(encryptedBase64Slice);});__cov_PgXs5Da8YdebSaLYg9T9iA.s['45']++;cs.catt=encryptedBase64Slices;}).then(function(){__cov_PgXs5Da8YdebSaLYg9T9iA.f['11']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['46']++;var filenameBuffer=me.convertUtf16StringToArrayBuffer(filename);__cov_PgXs5Da8YdebSaLYg9T9iA.s['47']++;var encryptionPromise=sc.encrypt({'name':cs.cipherAlgorithm,'iv':iv.buffer},cryptoKey,filenameBuffer);__cov_PgXs5Da8YdebSaLYg9T9iA.s['48']++;encryptionPromise.then(function(val){__cov_PgXs5Da8YdebSaLYg9T9iA.f['12']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['49']++;var byteArray=new Uint8Array(val);__cov_PgXs5Da8YdebSaLYg9T9iA.s['50']++;var encryptedBase64Filename=me.convertUint8ArrayToBase64String(byteArray);__cov_PgXs5Da8YdebSaLYg9T9iA.s['51']++;cs.cattname=encryptedBase64Filename;__cov_PgXs5Da8YdebSaLYg9T9iA.s['52']++;resolve();}).catch(function(reason){__cov_PgXs5Da8YdebSaLYg9T9iA.f['13']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['53']++;reject(reason);});}).catch(function(reason){__cov_PgXs5Da8YdebSaLYg9T9iA.f['14']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['54']++;reject(reason);});});}else{__cov_PgXs5Da8YdebSaLYg9T9iA.b['2'][1]++;}__cov_PgXs5Da8YdebSaLYg9T9iA.s['55']++;return retval;},skipPasswdWarning);};__cov_PgXs5Da8YdebSaLYg9T9iA.s['56']++;SCA.getPayload=function(){__cov_PgXs5Da8YdebSaLYg9T9iA.f['15']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['57']++;return this.getAndClear('payload');};__cov_PgXs5Da8YdebSaLYg9T9iA.s['58']++;SCA.decrypt=function(){__cov_PgXs5Da8YdebSaLYg9T9iA.f['16']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['59']++;var me=this;__cov_PgXs5Da8YdebSaLYg9T9iA.s['60']++;var decryptionPromise=this.decryptWith(function(v,key,iv,adata,out){__cov_PgXs5Da8YdebSaLYg9T9iA.f['17']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['61']++;SCA.e('payload').value=out;__cov_PgXs5Da8YdebSaLYg9T9iA.s['62']++;var retval=Promise.resolve();__cov_PgXs5Da8YdebSaLYg9T9iA.s['63']++;if(encData.cattname){__cov_PgXs5Da8YdebSaLYg9T9iA.b['3'][0]++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['64']++;if(v<1.4){__cov_PgXs5Da8YdebSaLYg9T9iA.b['4'][0]++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['65']++;var encryptedFilenameBits=sjcl.codec.base64.toBits(encData.cattname);__cov_PgXs5Da8YdebSaLYg9T9iA.s['66']++;var decryptedFilenameBits=sjcl.mode[encData.mode].decrypt(key,encryptedFilenameBits,iv,adata,encData.ts);__cov_PgXs5Da8YdebSaLYg9T9iA.s['67']++;var decryptedFilename=sjcl.codec.utf8String.fromBits(decryptedFilenameBits);__cov_PgXs5Da8YdebSaLYg9T9iA.s['68']++;SCA.e('download-label').innerHTML=decryptedFilename;__cov_PgXs5Da8YdebSaLYg9T9iA.s['69']++;SCA.setDisplay('att-download','inline');__cov_PgXs5Da8YdebSaLYg9T9iA.s['70']++;var byteArrays=[];__cov_PgXs5Da8YdebSaLYg9T9iA.s['71']++;for(var i=0;i<encData.catt.length;i++){__cov_PgXs5Da8YdebSaLYg9T9iA.s['72']++;var sliceBits=sjcl.codec.base64.toBits(encData.catt[i]);__cov_PgXs5Da8YdebSaLYg9T9iA.s['73']++;var decryptedSlice=sjcl.mode[encData.mode].decrypt(key,sliceBits,iv,adata,encData.ts);__cov_PgXs5Da8YdebSaLYg9T9iA.s['74']++;var byteNumbersSlice=sjcl.codec.bytes.fromBits(decryptedSlice);__cov_PgXs5Da8YdebSaLYg9T9iA.s['75']++;var byteArraySlice=new Uint8Array(byteNumbersSlice);__cov_PgXs5Da8YdebSaLYg9T9iA.s['76']++;byteArrays.push(byteArraySlice);}__cov_PgXs5Da8YdebSaLYg9T9iA.s['77']++;SCA.attBlob=new Blob(byteArrays,{type:'application/octet-stream'});__cov_PgXs5Da8YdebSaLYg9T9iA.s['78']++;SCA.attName=decryptedFilename;}else{__cov_PgXs5Da8YdebSaLYg9T9iA.b['4'][1]++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['79']++;var sc=window.crypto.subtle;__cov_PgXs5Da8YdebSaLYg9T9iA.s['80']++;var promiseArray=[];__cov_PgXs5Da8YdebSaLYg9T9iA.s['81']++;var filenameBuffer=me.convertBase64StringToUint8Array(encData.cattname);__cov_PgXs5Da8YdebSaLYg9T9iA.s['82']++;var filenameDecryptionPromise=sc.decrypt({'name':encData.cipherAlgorithm,'iv':iv.buffer},key,filenameBuffer);__cov_PgXs5Da8YdebSaLYg9T9iA.s['83']++;promiseArray.push(filenameDecryptionPromise);__cov_PgXs5Da8YdebSaLYg9T9iA.s['84']++;for(var i=0;i<encData.catt.length;i++){__cov_PgXs5Da8YdebSaLYg9T9iA.s['85']++;var sliceBuffer=me.convertBase64StringToUint8Array(encData.catt[i]).buffer;__cov_PgXs5Da8YdebSaLYg9T9iA.s['86']++;var sliceDecryptionPromise=sc.decrypt({'name':encData.cipherAlgorithm,'iv':iv.buffer},key,sliceBuffer);__cov_PgXs5Da8YdebSaLYg9T9iA.s['87']++;promiseArray.push(sliceDecryptionPromise);}__cov_PgXs5Da8YdebSaLYg9T9iA.s['88']++;retval=new Promise(function(resolve,reject){__cov_PgXs5Da8YdebSaLYg9T9iA.f['18']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['89']++;Promise.all(promiseArray).then(function(decryptedArray){__cov_PgXs5Da8YdebSaLYg9T9iA.f['19']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['90']++;var filename=me.convertArrayBufferToUtf16String(decryptedArray[0]);__cov_PgXs5Da8YdebSaLYg9T9iA.s['91']++;SCA.e('download-label').innerHTML=filename;__cov_PgXs5Da8YdebSaLYg9T9iA.s['92']++;SCA.setDisplay('att-download','inline');__cov_PgXs5Da8YdebSaLYg9T9iA.s['93']++;var bytesArray=[];__cov_PgXs5Da8YdebSaLYg9T9iA.s['94']++;for(var i=1;i<decryptedArray.length;i++){__cov_PgXs5Da8YdebSaLYg9T9iA.s['95']++;var slice=new Uint8Array(decryptedArray[i]);__cov_PgXs5Da8YdebSaLYg9T9iA.s['96']++;bytesArray.push(slice);}__cov_PgXs5Da8YdebSaLYg9T9iA.s['97']++;SCA.attBlob=new Blob(bytesArray,{type:'application/octet-stream'});__cov_PgXs5Da8YdebSaLYg9T9iA.s['98']++;SCA.attName=filename;__cov_PgXs5Da8YdebSaLYg9T9iA.s['99']++;resolve();}).catch(function(reason){__cov_PgXs5Da8YdebSaLYg9T9iA.f['20']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['100']++;reject(reason);});});}}else{__cov_PgXs5Da8YdebSaLYg9T9iA.b['3'][1]++;}__cov_PgXs5Da8YdebSaLYg9T9iA.s['101']++;return retval;});__cov_PgXs5Da8YdebSaLYg9T9iA.s['102']++;decryptionPromise.catch(function(reason){__cov_PgXs5Da8YdebSaLYg9T9iA.f['21']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['103']++;console.log('Decryption failed due to: '+reason);});};__cov_PgXs5Da8YdebSaLYg9T9iA.s['104']++;SCA.decryptSJCL=function(){__cov_PgXs5Da8YdebSaLYg9T9iA.f['22']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['105']++;return this.decryptWith(function(v,prp,iv,adata,out){__cov_PgXs5Da8YdebSaLYg9T9iA.f['23']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['106']++;SCA.e('payload').value=out;__cov_PgXs5Da8YdebSaLYg9T9iA.s['107']++;if(encData.cattname){__cov_PgXs5Da8YdebSaLYg9T9iA.b['5'][0]++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['108']++;var encryptedFilenameBits=sjcl.codec.base64.toBits(encData.cattname);__cov_PgXs5Da8YdebSaLYg9T9iA.s['109']++;var decryptedFilenameBits=sjcl.mode[encData.mode].decrypt(prp,encryptedFilenameBits,iv,adata,encData.ts);__cov_PgXs5Da8YdebSaLYg9T9iA.s['110']++;var decryptedFilename=sjcl.codec.utf8String.fromBits(decryptedFilenameBits);__cov_PgXs5Da8YdebSaLYg9T9iA.s['111']++;SCA.e('download-label').innerHTML=decryptedFilename;__cov_PgXs5Da8YdebSaLYg9T9iA.s['112']++;SCA.setDisplay('att-download','inline');__cov_PgXs5Da8YdebSaLYg9T9iA.s['113']++;var byteArrays=[];__cov_PgXs5Da8YdebSaLYg9T9iA.s['114']++;for(var i=0;i<encData.catt.length;i++){__cov_PgXs5Da8YdebSaLYg9T9iA.s['115']++;var sliceBits=sjcl.codec.base64.toBits(encData.catt[i]);__cov_PgXs5Da8YdebSaLYg9T9iA.s['116']++;var decryptedSlice=sjcl.mode[encData.mode].decrypt(prp,sliceBits,iv,adata,encData.ts);__cov_PgXs5Da8YdebSaLYg9T9iA.s['117']++;var byteNumbersSlice=sjcl.codec.bytes.fromBits(decryptedSlice);__cov_PgXs5Da8YdebSaLYg9T9iA.s['118']++;var byteArraySlice=new Uint8Array(byteNumbersSlice);__cov_PgXs5Da8YdebSaLYg9T9iA.s['119']++;byteArrays.push(byteArraySlice);}__cov_PgXs5Da8YdebSaLYg9T9iA.s['120']++;SCA.attBlob=new Blob(byteArrays,{type:'application/octet-stream'});__cov_PgXs5Da8YdebSaLYg9T9iA.s['121']++;SCA.attName=decryptedFilename;}else{__cov_PgXs5Da8YdebSaLYg9T9iA.b['5'][1]++;}});};__cov_PgXs5Da8YdebSaLYg9T9iA.s['122']++;SCA.downloadDecrypted=function(){__cov_PgXs5Da8YdebSaLYg9T9iA.f['24']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['123']++;saveAs(this.attBlob,this.attName);};__cov_PgXs5Da8YdebSaLYg9T9iA.s['124']++;SCA.setUnlocked=function(isUnlocked){__cov_PgXs5Da8YdebSaLYg9T9iA.f['25']++;__cov_PgXs5Da8YdebSaLYg9T9iA.s['125']++;var lockedDisplay=isUnlocked?(__cov_PgXs5Da8YdebSaLYg9T9iA.b['6'][0]++,'none'):(__cov_PgXs5Da8YdebSaLYg9T9iA.b['6'][1]++,'inline');__cov_PgXs5Da8YdebSaLYg9T9iA.s['126']++;var unlockedDisplay=isUnlocked?(__cov_PgXs5Da8YdebSaLYg9T9iA.b['7'][0]++,'inline'):(__cov_PgXs5Da8YdebSaLYg9T9iA.b['7'][1]++,'none');__cov_PgXs5Da8YdebSaLYg9T9iA.s['127']++;this.setDisplay('locked',lockedDisplay);__cov_PgXs5Da8YdebSaLYg9T9iA.s['128']++;this.setDisplay('unlocked',unlockedDisplay);};
